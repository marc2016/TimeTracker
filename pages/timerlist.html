<div id="timerlistMainContent">
  <div class="dateSelector">
    <a class="btn btn-default btnDateChange" id="btnPreviousDay" style="float: left;">
      <i class="fa fa-angle-double-left" title="Zurück"></i>
    </a>
    <input id="textCurrentDate" type='text' class="currentDate" data-position="right top" readonly />
    <a class="btn btn-default btnDateChange" id="btnNextDay" style="float: right;">
      <i class="fa fa-angle-double-right" title="Weiter"></i>
    </a>
    <hr class="hLine">
  </div>

  <div>
    <ul class="list-group" id="list" data-bind="foreach: jobTimerList">
      <li class="list-group-item job-list-item" data-bind="attr: { id: _id }, css: { 'currentEntry': isRunning }">
        <div class="container-fluid">
          <div class="form-row">
            <div class="col input-group-sm">
              <input data-bind="textInput: description, attr: { id: 'text-input-job_'+_id() }" class="form-control text-input-job"
                type="text" placeholder="Tätigkeit">
              <div class="row">
                <div class="col-md-auto" id="timerCell" data-toggle="modal" data-target="#modalChangeJobDuration"
                  data-bind="attr: { jobId: _id(), duration: $parent.getFormatedDuration(elapsedSeconds()) }">
                  <div class="row no-gutters" style="cursor: pointer;">
                    <div class="col-sm-auto" style="margin-right: 3px">Dauer: </div>
                    <div class="col-sm-auto">
                      <span data-bind="text: $parent.getTimeString(elapsedSeconds())" id="textTimer"></span>

                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-2 collapsedBySize">
              <select class="selectpicker form-control-sm projectSelect" style="width: 100%" data-bind="options: $parent.projectList, optionsCaption: 'Projekt auswählen...', optionsText: function(item) {
                        return item.name}, optionsValue: '_id', value: projectId">
              </select>
            </div>
            <div class="col-2 collapsedBySize">
              <select class="selectpicker form-control-sm jobtypeSelect" style="width: 100%" data-bind="options: $parent.jobtypeList, optionsCaption: 'Art der Aufgabe auswählen...', optionsText: function(item) {
                        return item.name}, optionsValue: '_id', value: jobtypeId">
              </select>
            </div>
            <div class="col-auto">
              <div class="btn-group btn-group-sm" role="group">
                <a class="btn btn-default timer-btn timer-btn-start" id="btnStart" data-bind="click: $parent.startTimer, css: { 'active': isRunning }">
                    <i class="fa fa-play timer-play-btn" title="Start"></i>
                    <i class="fa fa-pause timer-pause-btn" title="Pause"></i>
                </a>
                
                <a class="btn btn-default collapsedBySize timer-btn" id="btnAddNote" data-toggle="modal" data-target="#modalAddNote" data-bind="click: $parent.changeNoteClick.bind($data,$parent)">
                  <i class="fa fa-sticky-note" title="Notiz"></i>
                </a>
                <a class="btn btn-default collapsedBySize timer-btn" data-bind="click: $parent.syncEntry">
                  <i class="fas fa-sync-alt" title="Synchronisieren"></i>
                </a>
                <a class="btn btn-default collapsedBySize timer-btn" id="btnRemoveEntry" data-bind="click: $parent.removeItem">
                  <i class="fa fa-trash" title="Löschen"></i>
                </a>
                <div class="btn btn-default dropleft timer-btn" data-toggle="dropdown">
                  <i class="fa fa-angle-down" title="Mehr"></i>
                  <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" data-bind="click: $parent.changeNoteClick.bind($data,$parent)" data-toggle="modal" data-target="#modalAddNote"><i class="fa fa-sticky-note" title="Notiz"></i> Notiz</a>
                    <a class="dropdown-item" data-bind="click: $parent.transferEntry"><i class="fa fa-external-link" title="Übertragen"></i> Übertragen</a>
                    <a class="dropdown-item" data-bind="click: $parent.removeItem"><i class="fa fa-trash" title="Löschen"></i> Löschen</a>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>

<div class="modal fade" id="modalAddNote" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Notiz hinzufügen...</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3" data-bind="with: currentJob">
          <textarea type="text" class="form-control noteTextArea" aria-label="Default" aria-describedby="inputGroup-sizing-default" data-bind="value: jobNote"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="modalChangeJobDuration" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle">Dauer ändern...</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body">
              <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text" id="inputGroup-sizing-default">Dauer</span>
                  </div>
                  <input id="inputJobDuration" type="text" class="form-control" aria-label="Default" aria-describedby="inputGroup-sizing-default" >
                </div>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Abbruch</button>
              <button id="btnSaveDuration" type="button" class="btn btn-primary">Speichern</button>
          </div>
      </div>
  </div>
</div>